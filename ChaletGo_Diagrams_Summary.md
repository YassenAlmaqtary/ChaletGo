# 📊 ملخص المخططات - نظام ChaletGo

## 🎯 دليل المخططات للعرض التقديمي

---

## 1. 🔄 BFD - مخطط الوظائف التجارية

### الوظائف الرئيسية:
```
┌─────────────────────────────────────────┐
│              نظام ChaletGo              │
├─────────────────────────────────────────┤
│  إدارة المستخدمين  →  إدارة الشاليهات   │
│         ↓                    ↓          │
│  إدارة الحجوزات    →  إدارة المدفوعات   │
│         ↓                    ↓          │
│  إدارة التقييمات   →  إدارة التقارير    │
└─────────────────────────────────────────┘
```

### الوظائف الداعمة:
- 🔐 المصادقة والأمان
- 🖼️ إدارة الصور والملفات
- 📊 التحليلات والإحصائيات
- 🔔 نظام الإشعارات
- 💳 تكامل بوابات الدفع

---

## 2. 🌐 Context Diagram - مخطط السياق

### الكيانات الخارجية:
- **👤 العميل**: طلبات الحجز والدفع
- **🏠 مالك الشاليه**: بيانات الشاليهات والأسعار
- **👨‍💼 المدير**: إدارة النظام والمستخدمين
- **💳 بوابة الدفع**: معالجة المدفوعات
- **📱 خدمة الرسائل**: إشعارات SMS/Email

### تدفق البيانات:
```
العميل ←→ نظام ChaletGo ←→ بوابة الدفع
   ↕              ↕              ↕
المالك ←→ قاعدة البيانات ←→ خدمات الرسائل
```

---

## 3. 📊 DFD Level 0 - العمليات الرئيسية

### العمليات:
1. **1.0 إدارة المستخدمين**: تسجيل، تسجيل دخول، إدارة الملفات
2. **2.0 إدارة الشاليهات**: إضافة، تعديل، إدارة الصور والمرافق
3. **3.0 إدارة الحجوزات**: بحث، حجز، تأكيد، إلغاء
4. **4.0 معالجة المدفوعات**: دفع، تأكيد، استرداد
5. **5.0 إدارة التقييمات**: إضافة، عرض، إدارة المراجعات
6. **6.0 إنتاج التقارير**: إحصائيات، تقارير مالية، تحليلات

### مخازن البيانات:
- **D1**: المستخدمون
- **D2**: الشاليهات
- **D3**: الحجوزات
- **D4**: المدفوعات
- **D5**: التقييمات

---

## 4. 🔍 DFD Level 1 - تفصيل إدارة الحجوزات

### العمليات الفرعية:
- **3.1 البحث عن الشاليهات**: فلترة وترتيب النتائج
- **3.2 فحص التوفر**: التحقق من التواريخ المتاحة
- **3.3 إنشاء الحجز**: إدخال بيانات الحجز
- **3.4 تأكيد الحجز**: معالجة وتأكيد الطلب
- **3.5 إلغاء الحجز**: إلغاء وتحديث التوفر
- **3.6 تحديث حالة الحجز**: متابعة دورة حياة الحجز

---

## 5. 👥 Use Case Diagram - حالات الاستخدام

### للعملاء:
- تسجيل الدخول/إنشاء حساب
- البحث عن الشاليهات
- عرض تفاصيل الشاليه
- إنشاء حجز جديد
- معالجة الدفع
- إضافة تقييم
- إدارة الحجوزات الشخصية

### لأصحاب الشاليهات:
- إدارة الشاليهات
- رفع الصور
- إدارة الأسعار والتوفر
- متابعة الحجوزات
- الرد على التقييمات
- عرض التقارير المالية

### للمديرين:
- إدارة جميع المستخدمين
- مراجعة المحتوى
- إدارة المدفوعات
- إنتاج التقارير الشاملة
- مراقبة النظام

---

## 6. 🔄 Activity Diagram - عملية الحجز

### خطوات العملية:
1. **البداية**: دخول العميل للنظام
2. **المصادقة**: تسجيل دخول أو إنشاء حساب
3. **البحث**: البحث عن الشاليهات المناسبة
4. **الفلترة**: تطبيق المرشحات المطلوبة
5. **الاختيار**: اختيار الشاليه المناسب
6. **فحص التوفر**: التأكد من توفر التواريخ
7. **ملء البيانات**: إدخال تفاصيل الحجز
8. **اختيار الدفع**: تحديد طريقة الدفع
9. **معالجة الدفع**: تنفيذ عملية الدفع
10. **التأكيد**: تأكيد الحجز وإرسال الإشعارات

### نقاط القرار:
- هل المستخدم مسجل؟
- هل الشاليه متوفر؟
- هل البيانات صحيحة؟
- هل الدفع نجح؟

---

## 7. 🔄 Sequence Diagram - عملية الدفع

### المشاركون:
- **العميل**: المستخدم الذي يقوم بالدفع
- **ChaletGo API**: نظام الحجز
- **قاعدة البيانات**: تخزين البيانات
- **Moyasar Gateway**: بوابة الدفع
- **نظام الإشعارات**: إرسال التنبيهات

### تسلسل العمليات:
1. العميل يطلب دفع الحجز
2. النظام يتحقق من صحة الحجز
3. إنشاء عملية دفع في Moyasar
4. إرسال رابط الدفع للعميل
5. العميل يدخل بيانات البطاقة
6. Moyasar يعالج الدفع
7. إرسال webhook بالنتيجة
8. تحديث حالة الدفع والحجز
9. إرسال إشعار للعميل

---

## 8. 🗄️ ERD - مخطط قاعدة البيانات

### الجداول الرئيسية:

#### جدول المستخدمين (users):
- **id**: المعرف الفريد
- **name**: اسم المستخدم
- **email**: البريد الإلكتروني (فريد)
- **phone**: رقم الهاتف (فريد)
- **user_type**: نوع المستخدم (customer/owner/admin)
- **password**: كلمة المرور المشفرة

#### جدول الشاليهات (chalets):
- **id**: المعرف الفريد
- **owner_id**: معرف المالك (مفتاح خارجي)
- **name**: اسم الشاليه
- **description**: وصف الشاليه
- **location**: الموقع
- **price_per_night**: سعر الليلة
- **max_guests**: الحد الأقصى للضيوف

#### جدول الحجوزات (bookings):
- **id**: المعرف الفريد
- **customer_id**: معرف العميل (مفتاح خارجي)
- **chalet_id**: معرف الشاليه (مفتاح خارجي)
- **booking_number**: رقم الحجز (فريد)
- **check_in_date**: تاريخ الوصول
- **check_out_date**: تاريخ المغادرة
- **total_amount**: المبلغ الإجمالي
- **status**: حالة الحجز

#### جدول المدفوعات (payments):
- **id**: المعرف الفريد
- **booking_id**: معرف الحجز (مفتاح خارجي)
- **payment_method**: طريقة الدفع
- **amount**: المبلغ
- **status**: حالة الدفع
- **transaction_id**: معرف المعاملة

### العلاقات:
- **users → chalets**: واحد إلى متعدد (المالك يملك عدة شاليهات)
- **users → bookings**: واحد إلى متعدد (العميل يحجز عدة مرات)
- **chalets → bookings**: واحد إلى متعدد (الشاليه يُحجز عدة مرات)
- **bookings → payments**: واحد إلى متعدد (الحجز قد يحتوي على عدة مدفوعات)

---

## 9. 🏗️ Class Diagram - مخطط الفئات

### الفئات الرئيسية:

#### User (المستخدم):
```php
class User {
    +id: Long
    +name: String
    +email: String
    +userType: UserType
    +login()
    +logout()
    +updateProfile()
}
```

#### Chalet (الشاليه):
```php
class Chalet {
    +id: Long
    +name: String
    +pricePerNight: Decimal
    +maxGuests: Integer
    +isAvailable(checkIn, checkOut)
    +calculatePrice(nights)
}
```

#### Booking (الحجز):
```php
class Booking {
    +id: Long
    +bookingNumber: String
    +checkInDate: Date
    +checkOutDate: Date
    +totalAmount: Decimal
    +confirm()
    +cancel()
}
```

#### Payment (المدفوعة):
```php
class Payment {
    +id: Long
    +amount: Decimal
    +status: PaymentStatus
    +process()
    +refund()
}
```

### Controllers (المتحكمات):
- **BookingController**: إدارة الحجوزات
- **PaymentController**: إدارة المدفوعات
- **ChaletController**: إدارة الشاليهات

### Services (الخدمات):
- **MoyasarPaymentService**: خدمة الدفع
- **NotificationService**: خدمة الإشعارات
- **BookingService**: خدمة الحجوزات

---

## 10. 📋 Data Dictionary - قاموس البيانات

### أنواع البيانات المستخدمة:

#### الأنواع الأساسية:
- **BIGINT**: للمعرفات الفريدة
- **VARCHAR(255)**: للنصوص القصيرة
- **TEXT**: للنصوص الطويلة
- **DECIMAL(10,2)**: للمبالغ المالية
- **DATE**: للتواريخ
- **TIMESTAMP**: للتواريخ والأوقات
- **BOOLEAN**: للقيم المنطقية
- **JSON**: للبيانات المعقدة

#### الأنواع المخصصة (ENUM):
- **UserType**: customer, owner, admin
- **BookingStatus**: pending, confirmed, cancelled, completed
- **PaymentStatus**: pending, completed, failed, refunded
- **PaymentMethod**: credit_card, apple_pay, stc_pay, bank_transfer

### الفهارس والقيود:
- **Primary Keys**: جميع الجداول لها مفتاح أساسي
- **Foreign Keys**: مع CASCADE DELETE للحفاظ على التكامل
- **Unique Keys**: للبريد الإلكتروني، الهاتف، رقم الحجز
- **Indexes**: لتحسين أداء البحث والاستعلامات

---

## 📊 ملخص المخططات للعرض

### الشرائح المقترحة للعرض التقديمي:

#### الشريحة 1: BFD
- عرض الوظائف الرئيسية للنظام
- توضيح العلاقات بين الوظائف
- إبراز الوظائف الداعمة

#### الشريحة 2: Context Diagram
- عرض الكيانات الخارجية
- توضيح تدفق البيانات
- إبراز التكاملات الخارجية

#### الشريحة 3: DFD Level 0
- العمليات الرئيسية الستة
- مخازن البيانات الأساسية
- تدفق البيانات بين العمليات

#### الشريحة 4: Use Cases
- حالات الاستخدام لكل نوع مستخدم
- العلاقات بين المستخدمين والوظائف
- تغطية شاملة للمتطلبات

#### الشريحة 5: Activity Diagram
- خطوات عملية الحجز
- نقاط القرار المهمة
- تدفق العمل الكامل

#### الشريحة 6: Sequence Diagram
- تفاعل عملية الدفع
- التسلسل الزمني للعمليات
- التكامل مع بوابة الدفع

#### الشريحة 7: ERD
- هيكل قاعدة البيانات
- العلاقات بين الجداول
- الحقول الرئيسية

#### الشريحة 8: Class Diagram
- الفئات الرئيسية
- العلاقات بين الفئات
- الطرق والخصائص المهمة

### نصائح للعرض:
1. **ابدأ بالصورة الكبيرة**: BFD ثم Context
2. **انتقل للتفاصيل**: DFD Level 0 ثم Level 1
3. **اربط بالمتطلبات**: Use Cases
4. **وضح العمليات**: Activity و Sequence
5. **اختتم بالتقنيات**: ERD و Class Diagram

### أدوات العرض المقترحة:
- **PowerPoint**: للعرض الأساسي
- **Visio**: للمخططات التفصيلية
- **Draw.io**: للمخططات التفاعلية
- **Mermaid**: للمخططات البرمجية

---

*جميع المخططات متوفرة بصيغ متعددة ويمكن تخصيصها حسب احتياجات العرض*
